<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DANHS School Grades</title>
  <style>
    /* Add your CSS styles here */
  </style>
</head>
<body>

  <!-- Signup Form -->
  <div id="signupDiv">
    <h2>Signup</h2>
    <input type="email" id="signupEmail" placeholder="Email">
    <input type="password" id="signupPassword" placeholder="Password">
    <button type="button" id="togglePassword">Show Password</button>
    <button onclick="signup()">Sign Up</button>
    <p>Already have an account? <a href="#" id="gotoLogin">Login</a></p>
  </div>

  <!-- Login Form -->
  <div id="loginDiv" style="display:none;">
    <h2>Login</h2>
    <input type="email" id="loginEmail" placeholder="Email">
    <input type="password" id="loginPassword" placeholder="Password">
    <button type="button" id="toggleLoginPassword">Show Password</button>
    <button onclick="login()">Login</button>
    <p>Don't have an account? <a href="#" id="gotoSignup">Sign Up</a></p>
  </div>

  <!-- Admin Panel -->
  <div id="adminPanel" style="display:none;">
    <h2>Admin Panel</h2>
    <button onclick="showGrades()">View Grades</button>
    <button onclick="showUsers()">Manage Users</button>
    <button onclick="logout()">Logout</button>
  </div>

  <!-- Grades Table -->
  <div id="gradesTable" style="display:none;">
    <h2>Grades</h2>
    <table id="gradesList">
      <!-- Dynamic content will be inserted here -->
    </table>
  </div>

  <!-- Users Management -->
  <div id="usersManagement" style="display:none;">
    <h2>Manage Users</h2>
    <table id="usersList">
      <!-- Dynamic content will be inserted here -->
    </table>
  </div>

  <!-- My Info Panel -->
  <div id="myInfoPanel" style="display:none;">
    <h2>My Information</h2>
    <input type="text" id="myName" placeholder="Name">
    <input type="text" id="myNumber" placeholder="Mobile Number">
    <input type="text" id="myPurok" placeholder="Purok">
    <input type="text" id="myGuardian" placeholder="Parents/Guardian">
    <input type="text" id="myGuardianNumber" placeholder="Parents/Guardian Phone">
    <button onclick="saveInfo()">Save Info</button>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-firestore.js"></script>

  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCYPONQgJC33Lp2OmMyKw4hssDStEwvPlQ",
      authDomain: "test-9c727.firebaseapp.com",
      projectId: "test-9c727",
      storageBucket: "test-9c727.firebasestorage.app",
      messagingSenderId: "198578631587",
      appId: "1:198578631587:web:c0831122f964d46149e016"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Toggle Password Visibility
    document.getElementById('togglePassword').addEventListener('click', () => {
      const passwordField = document.getElementById('signupPassword');
      passwordField.type = passwordField.type === 'password' ? 'text' : 'password';
    });

    document.getElementById('toggleLoginPassword').addEventListener('click', () => {
      const passwordField = document.getElementById('loginPassword');
      passwordField.type = passwordField.type === 'password' ? 'text' : 'password';
    });

    // Switch to Login Form
    document.getElementById('gotoLogin').addEventListener('click', () => {
      document.getElementById('signupDiv').style.display = 'none';
      document.getElementById('loginDiv').style.display = 'block';
    });

    // Switch to Signup Form
    document.getElementById('gotoSignup').addEventListener('click', () => {
      document.getElementById('loginDiv').style.display = 'none';
      document.getElementById('signupDiv').style.display = 'block';
    });

    // Signup Function
    function signup() {
      const email = document.getElementById('signupEmail').value;
      const password = document.getElementById('signupPassword').value;
      auth.createUserWithEmailAndPassword(email, password)
        .then(userCredential => {
          const user = userCredential.user;
          db.collection('users').doc(user.uid).set({
            email: user.email,
            name: '',
            number: '',
            purok: '',
            guardian: '',
            guardianNumber: ''
          });
          alert('Signup successful!');
          document.getElementById('signupDiv').style.display = 'none';
          document.getElementById('loginDiv').style.display = 'block';
        })
        .catch(error => {
          alert(error.message);
        });
    }

    // Login Function
    function login() {
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      auth.signInWithEmailAndPassword(email, password)
        .then(userCredential => {
          const user = userCredential.user;
          checkUserRole(user);
        })
        .catch(error => {
          alert(error.message);
        });
    }

    // Check User Role
    function checkUserRole(user) {
      db.collection('users').doc(user.uid).get()
        .then(doc => {
          if (doc.exists) {
            const userData = doc.data();
            if (userData.role === 'admin') {
              showAdminPanel();
            } else {
              showStudentPanel(user);
            }
          } else {
            alert('No user data found');
          }
        })
        .catch(error => {
          alert(error.message);
        });
    }

    // Show Admin Panel
    function showAdminPanel() {
      document.getElementById('adminPanel').style.display = 'block';
      document.getElementById('loginDiv').style.display = 'none';
      document.getElementById('signupDiv').style.display = 'none';
    }

    // Show Student Panel
    function showStudentPanel(user) {
      document.getElementById('myInfoPanel').style.display = 'block';
      document.getElementById('loginDiv').style.display = 'none';
      document.getElementById('signupDiv').style.display = 'none';
      loadUserInfo(user);
    }

    // Load User Info
    function loadUserInfo(user) {
      db.collection('users').doc(user.uid).get()
        .then(doc => {
          if (doc.exists) {
            const userData = doc.data();
            document.getElementById('myName').value = userData.name;
            document.getElementById('myNumber').value = userData.number;
            document.getElementById('myPurok').value = userData.purok;
            document.getElementById('myGuardian').value = userData.guardian;
            document.getElementById('myGuardianNumber').value = userData.guardianNumber;
          } else {
            alert('No user data found');
          }
        })
        .catch(error => {
          alert(error.message);
        });
    }

    // Save User Info
    function saveInfo() {
      const user = auth.currentUser;
      if (user) {
        const name = document.getElementById('myName').value;
        const number = document.getElementById('myNumber').value;
        const purok = document.getElementById('myPurok').value;
        const guardian = document.getElementById('myGuardian').value;
        const guardianNumber = document.getElementById('myGuardianNumber').value;
        db.collection('users').doc(user.uid).update({
          name: name,
          number: number,
          purok: purok,
          guardian: guardian,
          guardianNumber: guardianNumber
        })
          .then(() => {
            alert('Information updated successfully');
          })
          .catch(error => {
            alert(error.message);
          });
      } else {
        alert('No user is signed in');
      }
    }

    // Logout Function
    function logout() {
      auth.signOut()
        .then(() => {
          document.getElementById('adminPanel').style.display = 'none';
          document.getElementById('myInfoPanel').style.display = 'none';
          document.getElementById('signupDiv').style.display = 'block';
          document.getElementById('loginDiv').style.display = 'none';
        })
        .catch(error => {
          alert(error.message);
        });
    }

    // Load Grades
    function loadGrades() {
      db.collection('grades').get()
        .then(querySnapshot => {
          const gradesList = document.getElementById('gradesList');
          gradesList.innerHTML = '';
          querySnapshot.forEach(doc => {
            const grade = doc.data();
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${grade.student}</td>
              <td>${grade.subject}</td>
              <td>${grade.grade}</td>
              <td class="${grade.grade >= 75 ? 'passed' : 'failed'}">${grade.grade >= 75 ? 'Passed' : 'Failed'}</td>
            `;
            gradesList.appendChild(row);
Ó®Å0Ó®Ç
            <script>
  // Admin Features

  // Show Grades Table
  function showGrades() {
    document.getElementById('gradesTable').style.display = 'block';
    document.getElementById('usersManagement').style.display = 'none';
    loadGrades();
  }

  // Show Users Management
  function showUsers() {
    document.getElementById('gradesTable').style.display = 'none';
    document.getElementById('usersManagement').style.display = 'block';
    loadUsers();
  }

  // Load Grades for Admin
  function loadGrades() {
    const gradesList = document.getElementById('gradesList');
    gradesList.innerHTML = `<tr><th>Student</th><th>Subject</th><th>Grade</th><th>Status</th></tr>`;
    db.collection('grades').get().then(snapshot => {
      snapshot.forEach(doc => {
        const grade = doc.data();
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${grade.student}</td>
          <td>${grade.subject}</td>
          <td>${grade.grade}</td>
          <td style="color:${grade.grade >=75 ? 'green':'red'};">${grade.grade >=75 ? 'Passed':'Failed'}</td>
        `;
        gradesList.appendChild(row);
      });
    });
  }

  // Load Users Table
  function loadUsers() {
    const usersList = document.getElementById('usersList');
    usersList.innerHTML = `<tr><th>Email</th><th>Name</th><th>Number</th><th>Purok</th><th>Guardian</th><th>Guardian Number</th><th>Action</th></tr>`;
    db.collection('users').get().then(snapshot => {
      snapshot.forEach(doc => {
        const user = doc.data();
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${user.email}</td>
          <td>${user.name}</td>
          <td>${user.number}</td>
          <td>${user.purok}</td>
          <td>${user.guardian}</td>
          <td>${user.guardianNumber}</td>
          <td><button onclick="deleteUser('${doc.id}')">Delete</button></td>
        `;
        usersList.appendChild(row);
      });
    });
  }

  // Delete User
  function deleteUser(uid) {
    if(confirm('Are you sure you want to delete this user?')) {
      db.collection('users').doc(uid).delete().then(() => {
        alert('User deleted!');
        loadUsers();
      }).catch(err => alert(err.message));
    }
  }

  // Hamburger Menu
  const menuDiv = document.createElement('div');
  menuDiv.id = 'hamburgerMenu';
  menuDiv.style.position = 'fixed';
  menuDiv.style.left = '-250px';
  menuDiv.style.top = '0';
  menuDiv.style.width = '250px';
  menuDiv.style.height = '100%';
  menuDiv.style.background = '#f1f1f1';
  menuDiv.style.transition = '0.3s';
  menuDiv.style.padding = '10px';
  menuDiv.innerHTML = `
    <h2>Menu</h2>
    <button onclick="showGrades()">Grades</button>
    <button onclick="showUsers()">Users</button>
    <button onclick="logout()">Logout</button>
  `;
  document.body.appendChild(menuDiv);

  const hamburgerBtn = document.createElement('button');
  hamburgerBtn.innerHTML = '&#9776;';
  hamburgerBtn.style.position = 'fixed';
  hamburgerBtn.style.top = '10px';
  hamburgerBtn.style.right = '10px';
  hamburgerBtn.style.fontSize = '30px';
  hamburgerBtn.style.zIndex = '1000';
  document.body.appendChild(hamburgerBtn);

  let menuOpen = false;
  hamburgerBtn.addEventListener('click', () => {
    if(menuOpen) {
      menuDiv.style.left = '-250px';
    } else {
      menuDiv.style.left = '0';
    }
    menuOpen = !menuOpen;
  });

  // Zoom functionality for grades table
  const zoomBtn = document.createElement('button');
  zoomBtn.innerHTML = 'üîç Zoom';
  zoomBtn.style.margin = '10px';
  document.getElementById('gradesTable').prepend(zoomBtn);

  zoomBtn.addEventListener('click', () => {
    const gradesTable = document.getElementById('gradesList');
    gradesTable.style.transform = gradesTable.style.transform === 'scale(1.5)' ? 'scale(1)' : 'scale(1.5)';
  });

  // Responsive adjustments
  window.addEventListener('resize', () => {
    const width = window.innerWidth;
    if(width < 768) {
      menuDiv.style.width = '200px';
    } else {
      menuDiv.style.width = '250px';
    }
  });
</script>
</body>
</html>
